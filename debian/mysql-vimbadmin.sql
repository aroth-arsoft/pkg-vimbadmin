CREATE TABLE admin (id BIGINT AUTO_INCREMENT NOT NULL, username VARCHAR(255) DEFAULT NULL, password VARCHAR(255) NOT NULL, super TINYINT(1) NOT NULL, active TINYINT(1) NOT NULL, created DATETIME NOT NULL, modified DATETIME DEFAULT NULL, UNIQUE INDEX IX_Username_1 (username), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE domain_admins (Admin_id BIGINT NOT NULL, Domain_id BIGINT NOT NULL, INDEX IDX_CD8319C69D5DE046 (Admin_id), INDEX IDX_CD8319C693AE8C46 (Domain_id), PRIMARY KEY(Admin_id, Domain_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE dbversion (id INT AUTO_INCREMENT NOT NULL, version INT NOT NULL, name VARCHAR(255) NOT NULL, applied_on DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE directory_entry (id BIGINT AUTO_INCREMENT NOT NULL, mailbox_id BIGINT NOT NULL, businessCategory VARCHAR(255) DEFAULT NULL, carLicense VARCHAR(255) DEFAULT NULL, departmentNumber VARCHAR(255) DEFAULT NULL, displayName VARCHAR(255) DEFAULT NULL, employeeNumber VARCHAR(255) DEFAULT NULL, employeeType VARCHAR(255) DEFAULT NULL, homePhone VARCHAR(255) DEFAULT NULL, homePostalAddress LONGTEXT DEFAULT NULL, initials VARCHAR(10) DEFAULT NULL, jpegPhoto LONGTEXT DEFAULT NULL COMMENT '(DC2Type:object)', labeledURI LONGTEXT DEFAULT NULL, mail VARCHAR(255) DEFAULT NULL, manager VARCHAR(255) DEFAULT NULL, mobile VARCHAR(255) DEFAULT NULL, o VARCHAR(255) DEFAULT NULL, pager VARCHAR(255) DEFAULT NULL, preferredLanguage VARCHAR(255) DEFAULT NULL, roomNumber VARCHAR(255) DEFAULT NULL, secretary VARCHAR(255) DEFAULT NULL, personalTitle VARCHAR(255) DEFAULT NULL, sn VARCHAR(255) DEFAULT NULL, ou VARCHAR(255) DEFAULT NULL, title VARCHAR(255) DEFAULT NULL, facsimileTelephoneNumber VARCHAR(255) DEFAULT NULL, givenName VARCHAR(255) DEFAULT NULL, telephoneNumber VARCHAR(255) DEFAULT NULL, vimb_created DATETIME NOT NULL, vimb_update DATETIME NOT NULL, UNIQUE INDEX UNIQ_6553C92D66EC35CC (mailbox_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE log (id BIGINT AUTO_INCREMENT NOT NULL, action VARCHAR(100) NOT NULL, data LONGTEXT DEFAULT NULL, timestamp DATETIME NOT NULL, Admin_id BIGINT DEFAULT NULL, Domain_id BIGINT DEFAULT NULL, INDEX IDX_8F3F68C59D5DE046 (Admin_id), INDEX IDX_8F3F68C593AE8C46 (Domain_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE domain (id BIGINT AUTO_INCREMENT NOT NULL, domain VARCHAR(255) NOT NULL, description VARCHAR(255) DEFAULT NULL, max_aliases INT NOT NULL, alias_count BIGINT NOT NULL, max_mailboxes INT NOT NULL, mailbox_count BIGINT NOT NULL, max_quota BIGINT NOT NULL, quota BIGINT NOT NULL, transport VARCHAR(255) NOT NULL, backupmx TINYINT(1) NOT NULL, active TINYINT(1) NOT NULL, homedir VARCHAR(255) DEFAULT NULL, maildir VARCHAR(255) DEFAULT NULL, uid INT DEFAULT NULL, gid INT DEFAULT NULL, created DATETIME NOT NULL, modified DATETIME DEFAULT NULL, UNIQUE INDEX IX_Domain_1 (domain), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE archive (id BIGINT AUTO_INCREMENT NOT NULL, username VARCHAR(255) NOT NULL, status VARCHAR(255) NOT NULL, archived_at DATETIME NOT NULL, status_changed_at DATETIME NOT NULL, homedir_server VARCHAR(255) DEFAULT NULL, homedir_file VARCHAR(255) DEFAULT NULL, homedir_orig_size BIGINT DEFAULT NULL, homedir_size BIGINT DEFAULT NULL, maildir_server VARCHAR(255) DEFAULT NULL, maildir_file VARCHAR(255) DEFAULT NULL, maildir_orig_size BIGINT DEFAULT NULL, maildir_size BIGINT DEFAULT NULL, data LONGTEXT NOT NULL, Domain_id BIGINT DEFAULT NULL, Admin_id BIGINT DEFAULT NULL, UNIQUE INDEX UNIQ_D5FC5D9CF85E0677 (username), INDEX IDX_D5FC5D9C93AE8C46 (Domain_id), INDEX IDX_D5FC5D9C9D5DE046 (Admin_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE mailbox (id BIGINT AUTO_INCREMENT NOT NULL, username VARCHAR(255) NOT NULL, password VARCHAR(255) NOT NULL, name VARCHAR(255) DEFAULT NULL, alt_email VARCHAR(255) DEFAULT NULL, quota BIGINT NOT NULL, local_part VARCHAR(255) NOT NULL, active TINYINT(1) NOT NULL, access_restriction VARCHAR(100) NOT NULL, homedir VARCHAR(255) DEFAULT NULL, maildir VARCHAR(255) DEFAULT NULL, uid BIGINT DEFAULT NULL, gid BIGINT DEFAULT NULL, homedir_size BIGINT DEFAULT NULL, maildir_size BIGINT DEFAULT NULL, size_at DATETIME DEFAULT NULL, delete_pending TINYINT(1) DEFAULT NULL, created DATETIME NOT NULL, modified DATETIME DEFAULT NULL, Domain_id BIGINT DEFAULT NULL, INDEX IDX_A69FE20B93AE8C46 (Domain_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE alias_pref (id BIGINT AUTO_INCREMENT NOT NULL, attribute VARCHAR(255) NOT NULL, ix INT NOT NULL, op VARCHAR(2) NOT NULL, value LONGTEXT NOT NULL, expire BIGINT NOT NULL, Alias_id BIGINT DEFAULT NULL, INDEX IDX_3279E911A72028B4 (Alias_id), INDEX IX_AliasPreference_1 (Alias_id, attribute, ix), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE admin_pref (id BIGINT AUTO_INCREMENT NOT NULL, attribute VARCHAR(255) NOT NULL, ix INT NOT NULL, op VARCHAR(2) NOT NULL, value LONGTEXT NOT NULL, expire BIGINT NOT NULL, Admin_id BIGINT DEFAULT NULL, INDEX IDX_814C1AD19D5DE046 (Admin_id), UNIQUE INDEX IX_AdminPreference_1 (Admin_id, attribute, ix), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE domain_pref (id BIGINT AUTO_INCREMENT NOT NULL, attribute VARCHAR(255) NOT NULL, ix INT NOT NULL, op VARCHAR(2) NOT NULL, value LONGTEXT NOT NULL, expire BIGINT NOT NULL, Domain_id BIGINT DEFAULT NULL, INDEX IDX_C89B55693AE8C46 (Domain_id), INDEX IX_DomainPreference_1 (Domain_id, attribute, ix), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE remember_me (id BIGINT AUTO_INCREMENT NOT NULL, userhash VARCHAR(40) NOT NULL, ckey VARCHAR(40) NOT NULL, original_ip VARCHAR(40) NOT NULL, expires DATETIME NOT NULL, last_used DATETIME NOT NULL, created DATETIME NOT NULL, Admin_id BIGINT DEFAULT NULL, INDEX IDX_7AF2A7289D5DE046 (Admin_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE alias (id BIGINT AUTO_INCREMENT NOT NULL, address VARCHAR(255) NOT NULL, `goto` LONGTEXT NOT NULL, active TINYINT(1) NOT NULL, created DATETIME NOT NULL, modified DATETIME DEFAULT NULL, Domain_id BIGINT DEFAULT NULL, UNIQUE INDEX UNIQ_E16C6B94D4E6F81 (address), INDEX IDX_E16C6B9493AE8C46 (Domain_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE mailbox_pref (id BIGINT AUTO_INCREMENT NOT NULL, attribute VARCHAR(255) NOT NULL, ix INT NOT NULL, op VARCHAR(2) NOT NULL, value LONGTEXT NOT NULL, expire BIGINT NOT NULL, Mailbox_id BIGINT DEFAULT NULL, INDEX IDX_F9C4B42A29B1361C (Mailbox_id), INDEX IX_MailboxPreference_1 (Mailbox_id, attribute, ix), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
ALTER TABLE domain_admins ADD CONSTRAINT FK_CD8319C69D5DE046 FOREIGN KEY (Admin_id) REFERENCES admin (id);
ALTER TABLE domain_admins ADD CONSTRAINT FK_CD8319C693AE8C46 FOREIGN KEY (Domain_id) REFERENCES domain (id);
ALTER TABLE directory_entry ADD CONSTRAINT FK_6553C92D66EC35CC FOREIGN KEY (mailbox_id) REFERENCES mailbox (id);
ALTER TABLE log ADD CONSTRAINT FK_8F3F68C59D5DE046 FOREIGN KEY (Admin_id) REFERENCES admin (id);
ALTER TABLE log ADD CONSTRAINT FK_8F3F68C593AE8C46 FOREIGN KEY (Domain_id) REFERENCES domain (id);
ALTER TABLE archive ADD CONSTRAINT FK_D5FC5D9C93AE8C46 FOREIGN KEY (Domain_id) REFERENCES domain (id);
ALTER TABLE archive ADD CONSTRAINT FK_D5FC5D9C9D5DE046 FOREIGN KEY (Admin_id) REFERENCES admin (id);
ALTER TABLE mailbox ADD CONSTRAINT FK_A69FE20B93AE8C46 FOREIGN KEY (Domain_id) REFERENCES domain (id);
ALTER TABLE alias_pref ADD CONSTRAINT FK_3279E911A72028B4 FOREIGN KEY (Alias_id) REFERENCES alias (id);
ALTER TABLE admin_pref ADD CONSTRAINT FK_814C1AD19D5DE046 FOREIGN KEY (Admin_id) REFERENCES admin (id);
ALTER TABLE domain_pref ADD CONSTRAINT FK_C89B55693AE8C46 FOREIGN KEY (Domain_id) REFERENCES domain (id);
ALTER TABLE remember_me ADD CONSTRAINT FK_7AF2A7289D5DE046 FOREIGN KEY (Admin_id) REFERENCES admin (id);
ALTER TABLE alias ADD CONSTRAINT FK_E16C6B9493AE8C46 FOREIGN KEY (Domain_id) REFERENCES domain (id);
ALTER TABLE mailbox_pref ADD CONSTRAINT FK_F9C4B42A29B1361C FOREIGN KEY (Mailbox_id) REFERENCES mailbox (id);
